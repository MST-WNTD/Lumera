@model Lumera.Models.ViewModels.RegisterLoginViewModel

@{
    Layout = null;
}

<!DOCTYPE html>
<html class="dark" lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lumera - Login/Signup</title>

    <!-- External Resources -->
    <link crossorigin href="https://fonts.gstatic.com/" rel="preconnect" />
    <link as="style" href="https://fonts.googleapis.com/css2?display=swap&amp;family=Manrope:wght@400;500;700;800&amp;family=Noto+Sans:wght@400;500;700;900"
          onload="this.rel='stylesheet'" rel="stylesheet" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#1773cf",
                        "background-light": "#f6f7f8",
                        "background-dark": "#111921",
                    },
                    fontFamily: {
                        "display": ["Manrope"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>

    <style>
        .form-select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        .dark .form-select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%234b5563' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
        }

        .role-specific {
            display: none;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-slate-800 dark:text-slate-200">
    <div class="flex items-center justify-center min-h-screen">
        <div class="w-full max-w-lg p-8 space-y-8 bg-white dark:bg-slate-900/50 rounded-xl shadow-2xl">

            <!-- Success Message -->
            @if (TempData["SuccessMessage"] != null)
            {
                <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative" role="alert">
                    <span class="block sm:inline">@TempData["SuccessMessage"]</span>
                </div>
            }

            <div x-data="{
                 tab: '@ViewBag.ActiveTab' ,
                 role: '' ,
                 showRoleFields(selectedRole) {
                 this.role=selectedRole;
                 // Hide all role-specific fields first
                 document.querySelectorAll('.role-specific').forEach(el=>
                el.style.display = 'none');
                // Show fields for selected role
                if (selectedRole) {
                document.querySelectorAll(`.role-${selectedRole.toLowerCase()}`).forEach(el => el.style.display = 'block');
                }
                }
                }">
                <div class="flex border-b border-slate-200 dark:border-slate-700">
                    <button :class="{ 'border-primary text-primary': tab === 'login', 'border-transparent text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200': tab !== 'login' }"
                            @@click="tab = 'login'"
                            class="flex-1 py-4 px-1 text-center border-b-2 font-medium text-sm transition-colors duration-300 focus:outline-none">
                        Log In
                    </button>
                    <button :class="{ 'border-primary text-primary': tab === 'signup', 'border-transparent text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200': tab !== 'signup' }"
                            @@click="tab = 'signup'"
                            class="flex-1 py-4 px-1 text-center border-b-2 font-medium text-sm transition-colors duration-300 focus:outline-none">
                        Sign Up
                    </button>
                </div>

                <div class="pt-8">
                    <!-- Login Form -->
                    <div x-show="tab === 'login'" x-transition>
                        <h2 class="text-2xl font-bold text-center text-slate-900 dark:text-white">Welcome Back</h2>
                        <p class="mt-2 text-center text-sm text-slate-600 dark:text-slate-400">
                            Log in to manage your events.
                        </p>

                        <form asp-action="Login" method="post" class="mt-8 space-y-6">
                            @Html.AntiForgeryToken()

                            <div class="space-y-4 rounded-md shadow-sm">
                                <div>
                                    <label class="sr-only" for="login-email">Email address</label>
                                    <input name="Email"
                                           value="@Model?.Email"
                                           class="appearance-none rounded-lg relative block w-full px-3 py-3 border border-slate-300 dark:border-slate-700 placeholder-slate-500 dark:placeholder-slate-400 text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                                           placeholder="Email address"
                                           type="email"
                                           required
                                           autocomplete="email"
                                           id="login-email" />
                                </div>
                                <div>
                                    <label class="sr-only" for="login-password">Password</label>
                                    <input name="Password"
                                           class="appearance-none rounded-lg relative block w-full px-3 py-3 border border-slate-300 dark:border-slate-700 placeholder-slate-500 dark:placeholder-slate-400 text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                                           placeholder="Password"
                                           required
                                           autocomplete="current-password"
                                           type="password"
                                           id="login-password" />
                                    <span asp-validation-for="Password" class="text-red-600 text-xs"></span>
                                </div>
                            </div>

                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <input asp-for="RememberMe"
                                           class="h-4 w-4 text-primary bg-slate-200 dark:bg-slate-700 border-slate-300 dark:border-slate-600 rounded focus:ring-primary"
                                           type="checkbox"
                                           id="remember-me" />
                                    <label class="ml-2 block text-sm text-slate-900 dark:text-slate-300" for="remember-me">Remember me</label>
                                </div>
                                <div class="text-sm">
                                    <a class="font-medium text-primary hover:text-primary/80" href="#">
                                        Forgot your password?
                                    </a>
                                </div>
                            </div>

                            <div>
                                <button type="submit" class="group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-semibold rounded-lg text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary focus:ring-offset-background-light dark:focus:ring-offset-background-dark">
                                    Log in
                                </button>
                            </div>

                            <!-- Display validation errors -->
                            @Html.ValidationSummary(true, "", new { @class = "text-red-600 text-sm" })
                        </form>
                    </div>

                    <!-- Signup Form -->
                    <div style="display: none;" x-show="tab === 'signup'" x-transition>
                        <h2 class="text-2xl font-bold text-center text-slate-900 dark:text-white">Create an Account</h2>
                        <p class="mt-2 text-center text-sm text-slate-600 dark:text-slate-400">
                            Join our platform to start planning.
                        </p>

                        <form asp-action="Register" method="post" class="mt-8 space-y-6">
                            @Html.AntiForgeryToken()

                            <div class="space-y-4 rounded-md shadow-sm">
                                <!-- Basic Information -->
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="sr-only" for="first-name">First Name</label>
                                        <input asp-for="FirstName"
                                               class="appearance-none rounded-lg relative block w-full px-3 py-3 border border-slate-300 dark:border-slate-700 placeholder-slate-500 dark:placeholder-slate-400 text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                                               placeholder="First Name"
                                               required
                                               id="first-name" />
                                        <span asp-validation-for="FirstName" class="text-red-600 text-xs"></span>
                                    </div>
                                    <div>
                                        <label class="sr-only" for="last-name">Last Name</label>
                                        <input asp-for="LastName"
                                               class="appearance-none rounded-lg relative block w-full px-3 py-3 border border-slate-300 dark:border-slate-700 placeholder-slate-500 dark:placeholder-slate-400 text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                                               placeholder="Last Name"
                                               required
                                               id="last-name" />
                                        <span asp-validation-for="LastName" class="text-red-600 text-xs"></span>
                                    </div>
                                </div>

                                <div>
                                    <label class="sr-only" for="signup-email">Email address</label>
                                    <input asp-for="Email"
                                           class="appearance-none rounded-lg relative block w-full px-3 py-3 border border-slate-300 dark:border-slate-700 placeholder-slate-500 dark:placeholder-slate-400 text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                                           placeholder="Email address"
                                           type="email"
                                           required
                                           autocomplete="email"
                                           id="signup-email" />
                                    <span asp-validation-for="Email" class="text-red-600 text-xs"></span>
                                </div>

                                <div>
                                    <label class="sr-only" for="phone">Phone Number</label>
                                    <input asp-for="Phone"
                                           class="appearance-none rounded-lg relative block w-full px-3 py-3 border border-slate-300 dark:border-slate-700 placeholder-slate-500 dark:placeholder-slate-400 text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                                           placeholder="Phone Number (Optional)"
                                           type="tel"
                                           id="phone" />
                                </div>

                                <div>
                                    <label class="sr-only" for="signup-password">Password</label>
                                    <input asp-for="Password"
                                           class="appearance-none rounded-lg relative block w-full px-3 py-3 border border-slate-300 dark:border-slate-700 placeholder-slate-500 dark:placeholder-slate-400 text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                                           placeholder="Password"
                                           required
                                           autocomplete="new-password"
                                           type="password"
                                           id="signup-password" />
                                    <span asp-validation-for="Password" class="text-red-600 text-xs"></span>
                                </div>
                                <div>
                                    <label class="sr-only" for="confirm-password">Confirm Password</label>
                                    <input asp-for="ConfirmPassword"
                                           class="appearance-none rounded-lg relative block w-full px-3 py-3 border border-slate-300 dark:border-slate-700 placeholder-slate-500 dark:placeholder-slate-400 text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                                           placeholder="Confirm Password"
                                           required
                                           autocomplete="new-password"
                                           type="password"
                                           id="confirm-password" />
                                    <span asp-validation-for="ConfirmPassword" class="text-red-600 text-xs"></span>
                                </div>
                                <div x-data="{ selectedRole: '' }" class="space-y-3">
                                    <p class="text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">Select your role</p>
                                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">

                                        <!-- Client -->
                                        <button type="button"
                                                @@click="selectedRole='Client'; showRoleFields('Client');"
                                                :class="selectedRole==='Client'
                    ? 'border-primary bg-primary/10 text-primary'
                    : 'border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-300'"
                                                class="flex flex-col items-center justify-center border rounded-lg py-4 transition-all hover:border-primary hover:bg-primary/10">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                                      d="M5.121 17.804A8 8 0 1118.88 6.195M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                                            </svg>
                                            <span class="font-semibold">Client</span>
                                        </button>

                                        <!-- Organizer -->
                                        <button type="button"
                                                @@click="selectedRole='Organizer'; showRoleFields('Organizer');"
                                                :class="selectedRole==='Organizer'
                    ? 'border-primary bg-primary/10 text-primary'
                    : 'border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-300'"
                                                class="flex flex-col items-center justify-center border rounded-lg py-4 transition-all hover:border-primary hover:bg-primary/10">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                                      d="M12 6v6l4 2" />
                                            </svg>
                                            <span class="font-semibold">Organizer</span>
                                        </button>

                                        <!-- Supplier -->
                                        <button type="button"
                                                @@click="selectedRole='Supplier'; showRoleFields('Supplier');"
                                                :class="selectedRole==='Supplier'
                    ? 'border-primary bg-primary/10 text-primary'
                    : 'border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-300'"
                                                class="flex flex-col items-center justify-center border rounded-lg py-4 transition-all hover:border-primary hover:bg-primary/10">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                                      d="M3 7h18M3 12h18M3 17h18" />
                                            </svg>
                                            <span class="font-semibold">Supplier</span>
                                        </button>
                                    </div>

                                    <!-- Hidden input for ASP.NET Model Binding -->
                                    <input type="hidden" asp-for="Role" :value="selectedRole" required />
                                    <span asp-validation-for="Role" class="text-red-600 text-xs"></span>
                                </div>


                                <!-- Organizer Specific Fields -->
                                <div class="role-specific role-organizer space-y-4">
                                    <div>
                                        <label class="sr-only" for="business-name">Business Name</label>
                                        <input asp-for="BusinessName"
                                               class="appearance-none rounded-lg relative block w-full px-3 py-3 border border-slate-300 dark:border-slate-700 placeholder-slate-500 dark:placeholder-slate-400 text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                                               placeholder="Business Name"
                                               id="business-name" />
                                    </div>
                                    <div>
                                        <label class="sr-only" for="business-description">Business Description</label>
                                        <textarea asp-for="BusinessDescription"
                                                  class="appearance-none rounded-lg relative block w-full px-3 py-3 border border-slate-300 dark:border-slate-700 placeholder-slate-500 dark:placeholder-slate-400 text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                                                  placeholder="Business Description"
                                                  rows="3"
                                                  id="business-description"></textarea>
                                    </div>
                                    <div>
                                        <label class="sr-only" for="years-experience">Years of Experience</label>
                                        <input asp-for="YearsOfExperience"
                                               class="appearance-none rounded-lg relative block w-full px-3 py-3 border border-slate-300 dark:border-slate-700 placeholder-slate-500 dark:placeholder-slate-400 text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                                               placeholder="Years of Experience"
                                               type="number"
                                               min="0"
                                               id="years-experience" />
                                    </div>
                                </div>

                                <!-- Supplier Specific Fields -->
                                <div class="role-specific role-supplier space-y-4">
                                    <div>
                                        <label class="sr-only" for="supplier-business-name">Business Name</label>
                                        <input asp-for="BusinessName"
                                               class="appearance-none rounded-lg relative block w-full px-3 py-3 border border-slate-300 dark:border-slate-700 placeholder-slate-500 dark:placeholder-slate-400 text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                                               placeholder="Business Name"
                                               id="supplier-business-name" />
                                    </div>
                                    <div>
                                        <label class="sr-only" for="service-category">Service Category</label>
                                        <input asp-for="ServiceCategory"
                                               class="appearance-none rounded-lg relative block w-full px-3 py-3 border border-slate-300 dark:border-slate-700 placeholder-slate-500 dark:placeholder-slate-400 text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                                               placeholder="Service Category (e.g., Catering, Photography)"
                                               id="service-category" />
                                    </div>
                                    <div>
                                        <label class="sr-only" for="supplier-business-description">Business Description</label>
                                        <textarea asp-for="BusinessDescription"
                                                  class="appearance-none rounded-lg relative block w-full px-3 py-3 border border-slate-300 dark:border-slate-700 placeholder-slate-500 dark:placeholder-slate-400 text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                                                  placeholder="Business Description"
                                                  rows="3"
                                                  id="supplier-business-description"></textarea>
                                    </div>
                                    <div>
                                        <label class="sr-only" for="supplier-years-experience">Years of Experience</label>
                                        <input asp-for="YearsOfExperience"
                                               class="appearance-none rounded-lg relative block w-full px-3 py-3 border border-slate-300 dark:border-slate-700 placeholder-slate-500 dark:placeholder-slate-400 text-slate-900 dark:text-white bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                                               placeholder="Years of Experience"
                                               type="number"
                                               min="0"
                                               id="supplier-years-experience" />
                                    </div>
                                </div>
                            </div>

                            <div class="text-xs text-center text-slate-500 dark:text-slate-400">
                                <p>Client accounts are approved instantly. Organizer and Supplier accounts require admin approval.</p>
                            </div>

                            <div>
                                <button type="submit" class="group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-semibold rounded-lg text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary focus:ring-offset-background-light dark:focus:ring-offset-background-dark">
                                    Sign up
                                </button>
                            </div>

                            <!-- Display validation errors -->
                            @Html.ValidationSummary(true, "", new { @class = "text-red-600 text-sm" })
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- jQuery Validation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.12/jquery.validate.unobtrusive.min.js"></script>
</body>
</html>